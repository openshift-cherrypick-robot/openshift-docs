// Module included in the following assemblies:
//
// * operating/manage-network-policies.adoc
:_mod-docs-content-type: CONCEPT
[id="network-graph-20-view_{context}"]
= About the network graph

[role="_abstract"]

The network graph provides high-level and detailed information about deployments, network flows, and network policies in your environment.

{product-title-short} processes all network policies in each secured cluster to show you which deployments can contact each other and which can reach external networks. It also monitors running deployments and tracks traffic between them. You can view the following items in the network graph:

External entities:: These represent entities that are connected outside of your cluster. For more information, see "External entities and connections in the network graph".
Internal entities:: These represent entities that are connected inside of your cluster and are not considered external. Internal entities are displayed when Sensor is unable to match connections to existing deployments, but the involved IP address is part of the cluster's internal networks. Based on the IP addresses, the system has determined that those flows do not leave the cluster. For more information about the kind of connections that are considered internal, see "Connections involving internal entities".
Network components:: From the top menu, you can select namespaces (indicated by the *NS* label) and deployments (indicated by the *D* label) to display on the graph for a chosen cluster (indicated by the *CL* label). You can further filter deployments by using the drop-down list and selecting criteria on which to filter, such as common vulnerabilities and exposures (CVEs), labels, and images.
Network flows:: You can select one of the following flows for the graph:
Active traffic:: Selecting this default option shows observed traffic, focused on the namespace or specific deployment that you selected. You can select the time period for which to display information.
Inactive flows:: Selecting this option shows potential flows allowed by your network policies, helping you identify missing network policies needed to achieve tighter isolation. You can select the time period for which to display information.
Network policies:: You can view existing policies for a selected component or view components that have no policies. You can also simulate network policies from the network graph view. See "Simulating network policies from the network graph" for more information.

[id="navigation-user-interface_{context}"]
== Displays, navigation, and the user interface in the network graph

You can use the network graph, shown in the following graphic, to click on items and view additional information about them. You can also perform actions within the graph such as adding a network flow to your baseline.

.Network graph example
image::network-graph-20-overview-updated.png[Overview of the Network graph showing deployments]

The following tips can help you use the network graph:

* Opening the legend provides information about the symbols in use and their meaning. The legend shows explanatory text for symbols representing namespaces, deployments, and connections on the network graph.
* Selecting additional display options from the drop-down list controls whether the graph displays icons such as the network policy status badge, active external traffic badge, and port and protocol labels for edge connections.
* {product-title-short} detects changes in network traffic, such as nodes joining or leaving. If changes are detected, the network graph displays a notification showing the number of updates available. To avoid interrupting your focus, the graph is not updated automatically. Click the notification to update the graph.

When you click an item in the graph, the rearranged side panel with collapsible sections presents information about that item. You can click on the following items:

* Deployments
* Namespaces
* External entities
* CIDR blocks
* External groups

The side panel displays relevant information based on the item in the graph that you have selected. The *D* or *NS* label next to the item name in the header (in this example, "visa-processor") indicates if it is a deployment or a namespace. The following example illustrates the side panel for a deployment.

.Side panel for a deployment example
image::network-graph-20-deployment-mode-updated.png[Side panel for a deployment]

When viewing a namespace, the side panel includes a search bar and a list of deployments. You can click on a deployment to view its information. The side panel also includes a *Network policies* tab. From this tab, you can view, copy to the clipboard, or export any network policy defined in that namespace, as shown in the following example.

.Side panel for a namespace example
image::network-graph-20-namespace-mode.png[Side panel for a namespace showing network policy information]

[id="external-entities-connections_{context}"]
== External entities and connections in the network graph

The network graph view shows network connections between managed clusters and external sources.
In addition, {product-title-short} automatically discovers and highlights public Classless Inter-Domain Routing (CIDR) address blocks, such as Google Cloud, AWS, Microsoft Azure, Oracle Cloud, and Cloudflare.
Using this information, you can identify deployments with active external connections and decide if they are making or receiving unauthorized connections from outside your network.

By default, the external connections point to a common *External Entities* icon and different CIDR address blocks in the network graph.
However, you can choose not to show auto-discovered CIDR blocks by clicking *Manage CIDR blocks* and deselecting *Auto-discovered CIDR blocks*.

{product-title-short} includes IP ranges for the following cloud providers:

* Google Cloud
* AWS
* Microsoft Azure
* Oracle Cloud
* Cloudflare

{product-title-short} fetches and updates the cloud providers' IP ranges every 7 days, and updates CIDR blocks daily.
If you are using offline mode, you can update these ranges by installing new support packages.

The following image provides an example of the network graph. In this example, based on the options that the user has chosen, the graph depicts deployments in the selected namespace. Traffic flows are not displayed until you click on an item such as a deployment. The graph uses a red badge to indicate deployments that are missing policies and therefore allowing all network traffic.

[id="internal-entities-connections_{context}"]
== Connections involving internal entities

The network graph is useful for identifying deployments with active connections to entities that do not belong to any known deployment or CIDR block. Some of these connections never reach outside of the cluster and are made within the cluster's private network. The network graph represents those as connections to or from _internal entities_.

Connections with internal entities represent a connection between a deployment and an IP address that belongs to the private address space as defined in http://datatracker.ietf.org/doc/html/rfc1918[RFC 1918]. In some cases, Sensor is unable to identify one or both deployments involved in a connection. In that case, the system analyzes the IP address and decides whether the connection is internal or external.

The following scenarios can lead to a connection being categorized as one involving internal entities:

* A change of IP address or the deletion of a deployment accepting connections (the server) while the party initiating the connection (the client) still attempts to reach it
* A deployment communicating with the orchestrator API
* A deployment communicating using a networking CNI plugin, for example, Calico
* A restart of Sensor, resulting in a reset of the mapping of IP addresses to past deployments, for example, when Sensor does not recognize the IP addresses of past entities or past IP addresses of existing entities

Internal entities are indicated with an icon as shown in the following graphic. Clicking on *Internal entities* shows the flows for these entities.

.Internal entities example
image::network-graph-internal-entities.png[Network graph showing internal entities]

